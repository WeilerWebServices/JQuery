/*
 * jQuery Nivo Slider v1.3
 * http://nivo.dev7studios.com
 *
 * Copyright 2010, Gilbert Pellegrom
 * Free to use and abuse under the GPL license.
 * http://www.gnu.org/copyleft/gpl.html
 * 
 * March 2010
 */
(function(a){a.fn.nivoSlider=function(e){var i=0;var g="";var h=0;var c="";var b=false;var f=false;settings=jQuery.extend({effect:"random",slices:15,animSpeed:500,pauseTime:3000,directionNav:true,directionNavHide:true,controlNav:true,pauseOnHover:true,beforeChange:function(){},afterChange:function(){}},e);return this.each(function(){var m=a(this);m.css("position","relative");m.width("1px");m.height("1px");m.addClass("nivoSlider");var j=m.children();j.each(function(){var p="";if(a(this).is("img")){p=a(this)}else{p=a(this).find("img:first");if(a(this).is("a")){a(this).addClass("nivo-imageLink")}}if(p.width()>m.width()){m.width(p.width())}if(p.height()>m.height()){m.height(p.height())}p.css("display","none");h++});if(a(j[i]).is("img")){g=a(j[i])}else{g=a(j[i]).find("img:first")}if(a(j[i]).is("a")){a(j[i]).css("display","block")}m.css("background","url("+g.attr("src")+") no-repeat");for(var k=0;k<settings.slices;k++){var n=Math.round(m.width()/settings.slices);if(k==settings.slices-1){m.append(a('<div class="nivo-slice"></div>').css({left:(n*k)+"px",width:(m.width()-(n*k))+"px"}))}else{m.append(a('<div class="nivo-slice"></div>').css({left:(n*k)+"px",width:n+"px"}))}}m.append(a('<div class="nivo-caption"><p></p></div>').css("display","none"));if(g.attr("title")!=""){a(".nivo-caption p",m).html(g.attr("title"));a(".nivo-caption",m).fadeIn(settings.animSpeed)}var o=setInterval(function(){d(m,j,settings,false)},settings.pauseTime);if(settings.directionNav){m.append('<div class="nivo-directionNav"><a class="nivo-prevNav">Prev</a><a class="nivo-nextNav">Next</a></div>');if(settings.directionNavHide){a(".nivo-directionNav",m).hide();m.hover(function(){a(".nivo-directionNav",m).show()},function(){a(".nivo-directionNav",m).hide()})}a("a.nivo-prevNav",m).live("click",function(){if(b){return false}clearInterval(o);o="";i-=2;d(m,j,settings,"prev")});a("a.nivo-nextNav",m).live("click",function(){if(b){return false}clearInterval(o);o="";d(m,j,settings,"next")})}if(settings.controlNav){var l=a('<div class="nivo-controlNav"></div>');m.append(l);for(var k=0;k<j.length;k++){l.append('<a class="nivo-control" rel="'+k+'">'+(k+1)+"</a>")}a(".nivo-controlNav a:eq("+i+")",m).addClass("active");a(".nivo-controlNav a",m).live("click",function(){if(b){return false}clearInterval(o);o="";m.css("background","url("+g.attr("src")+") no-repeat");i=a(this).attr("rel")-1;d(m,j,settings,"control")})}if(settings.pauseOnHover){m.hover(function(){f=true;clearInterval(o);o=""},function(){f=false;if(o==""){o=setInterval(function(){d(m,j,settings,false)},settings.pauseTime)}})}m.bind("nivo:animFinished",function(){b=false;a(j).each(function(){if(a(this).is("a")){a(this).css("display","none")}});if(a(j[i]).is("a")){a(j[i]).css("display","block")}if(o==""&&!f){o=setInterval(function(){d(m,j,settings,false)},settings.pauseTime)}settings.afterChange.call(this)})});function d(j,k,m,o){m.beforeChange.call(this);if(!o){j.css("background","url("+g.attr("src")+") no-repeat")}else{if(o=="prev"){j.css("background","url("+g.attr("src")+") no-repeat")}if(o=="next"){j.css("background","url("+g.attr("src")+") no-repeat")}}i++;if(i==h){i=0}if(i<0){i=(h-1)}if(a(k[i]).is("img")){g=a(k[i])}else{g=a(k[i]).find("img:first")}if(m.controlNav){a(".nivo-controlNav a",j).removeClass("active");a(".nivo-controlNav a:eq("+i+")",j).addClass("active")}if(g.attr("title")!=""){if(a(".nivo-caption",j).css("display")=="block"){a(".nivo-caption p",j).fadeOut(m.animSpeed,function(){a(this).html(g.attr("title"));a(this).fadeIn(m.animSpeed)})}else{a(".nivo-caption p",j).html(g.attr("title"))}a(".nivo-caption",j).fadeIn(m.animSpeed)}else{a(".nivo-caption",j).fadeOut(m.animSpeed)}var n=0;a(".nivo-slice",j).each(function(){var s=Math.round(j.width()/m.slices);a(this).css({height:"0px",opacity:"0",background:"url("+g.attr("src")+") no-repeat -"+((s+(n*s))-s)+"px 0%"});n++});if(m.effect=="random"){var p=new Array("sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade");c=p[Math.floor(Math.random()*(p.length+1))];if(c==undefined){c="fade"}}b=true;if(m.effect=="sliceDown"||m.effect=="sliceDownRight"||c=="sliceDownRight"||m.effect=="sliceDownLeft"||c=="sliceDownLeft"){var l=0;var n=0;var r=a(".nivo-slice",j);if(m.effect=="sliceDownLeft"||c=="sliceDownLeft"){r=a(".nivo-slice",j).reverse()}r.each(function(){var s=a(this);s.css("top","0px");if(n==m.slices-1){setTimeout(function(){s.animate({height:"100%",opacity:"1.0"},m.animSpeed,"",function(){j.trigger("nivo:animFinished")})},(100+l))}else{setTimeout(function(){s.animate({height:"100%",opacity:"1.0"},m.animSpeed)},(100+l))}l+=50;n++})}else{if(m.effect=="sliceUp"||m.effect=="sliceUpRight"||c=="sliceUpRight"||m.effect=="sliceUpLeft"||c=="sliceUpLeft"){var l=0;var n=0;var r=a(".nivo-slice",j);if(m.effect=="sliceUpLeft"||c=="sliceUpLeft"){r=a(".nivo-slice",j).reverse()}r.each(function(){var s=a(this);s.css("bottom","0px");if(n==m.slices-1){setTimeout(function(){s.animate({height:"100%",opacity:"1.0"},m.animSpeed,"",function(){j.trigger("nivo:animFinished")})},(100+l))}else{setTimeout(function(){s.animate({height:"100%",opacity:"1.0"},m.animSpeed)},(100+l))}l+=50;n++})}else{if(m.effect=="sliceUpDown"||m.effect=="sliceUpDownRight"||c=="sliceUpDown"||m.effect=="sliceUpDownLeft"||c=="sliceUpDownLeft"){var l=0;var n=0;var q=0;var r=a(".nivo-slice",j);if(m.effect=="sliceUpDownLeft"||c=="sliceUpDownLeft"){r=a(".nivo-slice",j).reverse()}r.each(function(){var s=a(this);if(n==0){s.css("top","0px");n++}else{s.css("bottom","0px");n=0}if(q==m.slices-1){setTimeout(function(){s.animate({height:"100%",opacity:"1.0"},m.animSpeed,"",function(){j.trigger("nivo:animFinished")})},(100+l))}else{setTimeout(function(){s.animate({height:"100%",opacity:"1.0"},m.animSpeed)},(100+l))}l+=50;q++})}else{if(m.effect=="fold"||c=="fold"){var l=0;var n=0;a(".nivo-slice",j).each(function(){var s=a(this);var t=s.width();s.css({top:"0px",height:"100%",width:"0px"});if(n==m.slices-1){setTimeout(function(){s.animate({width:t,opacity:"1.0"},m.animSpeed,"",function(){j.trigger("nivo:animFinished")})},(100+l))}else{setTimeout(function(){s.animate({width:t,opacity:"1.0"},m.animSpeed)},(100+l))}l+=50;n++})}else{if(m.effect=="fade"||c=="fade"){var n=0;a(".nivo-slice",j).each(function(){a(this).css("height","100%");if(n==m.slices-1){a(this).animate({opacity:"1.0"},(m.animSpeed*2),"",function(){j.trigger("nivo:animFinished")})}else{a(this).animate({opacity:"1.0"},(m.animSpeed*2))}n++})}}}}}}};a.fn.reverse=[].reverse})(jQuery);